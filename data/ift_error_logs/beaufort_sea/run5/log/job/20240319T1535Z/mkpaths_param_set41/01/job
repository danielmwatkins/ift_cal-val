#!/bin/bash -l
#
# ++++ THIS IS A CYLC JOB SCRIPT ++++
# Workflow: beaufort_sea/run5
# Task: 20240319T1535Z/mkpaths_param_set41
# Job log directory: 20240319T1535Z/mkpaths_param_set41/01
# Job runner: background
if [[ $1 == 'noreinvoke' ]]; then
    shift
else
    exec bash -l "$0" noreinvoke "$@"
fi

CYLC_FAIL_SIGNALS='EXIT ERR TERM XCPU'
export CYLC_VERBOSE=false
export CYLC_DEBUG=false
export CYLC_VERSION='8.2.1'
export CYLC_WORKFLOW_ID="beaufort_sea/run5"

cylc__job__inst__cylc_env() {
    # CYLC WORKFLOW ENVIRONMENT:
    export CYLC_CYCLING_MODE="gregorian"
    export CYLC_UTC="False"
    export CYLC_WORKFLOW_FINAL_CYCLE_POINT="None"
    export CYLC_WORKFLOW_INITIAL_CYCLE_POINT="20240319T1535Z"
    export CYLC_WORKFLOW_NAME="beaufort_sea"
    export CYLC_WORKFLOW_NAME_BASE="beaufort_sea"
    export CYLC_WORKFLOW_UUID="88282787-7b5f-46ac-ba70-cba6e40ddcfb"

    # CYLC TASK ENVIRONMENT:
    export CYLC_TASK_COMMS_METHOD=zmq
    export CYLC_TASK_JOB="20240319T1535Z/mkpaths_param_set41/01"
    export CYLC_TASK_NAMESPACE_HIERARCHY="root mkpaths_param_set41"
    export CYLC_TASK_DEPENDENCIES="20240319T1535Z/global_setup"
    export CYLC_TASK_TRY_NUMBER=1
    export CYLC_TASK_FLOW_NUMBERS=1
    export CYLC_TASK_PARAM_param_set="41"
}

cylc__job__inst__user_env() {
    # TASK RUNTIME ENVIRONMENT:
    export location startdate enddate crs bounding_box centroid_lat centroid_lon minfloearea maxfloearea project_dir t julia_exec report_dir results_dir fetchdata_dir truecolor_dir falsecolor_dir
    location="beaufort_sea-100km_by_100km-20030422-20030423,beaufort_sea-100km_by_100km-20030422-20030423,beaufort_sea-100km_by_100km-20030527-20030528,beaufort_sea-100km_by_100km-20030527-20030528,beaufort_sea-100km_by_100km-20030616-20030617,beaufort_sea-100km_by_100km-20030616-20030617,beaufort_sea-100km_by_100km-20030621-20030622,beaufort_sea-100km_by_100km-20030621-20030622,beaufort_sea-100km_by_100km-20040428-20040429,beaufort_sea-100km_by_100km-20040428-20040429,beaufort_sea-100km_by_100km-20070711-20070712,beaufort_sea-100km_by_100km-20070711-20070712,beaufort_sea-100km_by_100km-20100330-20100331,beaufort_sea-100km_by_100km-20100330-20100331,beaufort_sea-100km_by_100km-20100925-20100926,beaufort_sea-100km_by_100km-20100925-20100926,beaufort_sea-100km_by_100km-20110608-20110609,beaufort_sea-100km_by_100km-20110608-20110609,beaufort_sea-100km_by_100km-20140818-20140819,beaufort_sea-100km_by_100km-20140818-20140819,beaufort_sea-100km_by_100km-20170525-20170526,beaufort_sea-100km_by_100km-20170525-20170526,beaufort_sea-100km_by_100km-20170925-20170926,beaufort_sea-100km_by_100km-20170925-20170926,beaufort_sea-100km_by_100km-20180925-20180926,beaufort_sea-100km_by_100km-20180925-20180926,beaufort_sea-100km_by_100km-20190319-20190320,beaufort_sea-100km_by_100km-20190319-20190320,beaufort_sea-100km_by_100km-20190808-20190809,beaufort_sea-100km_by_100km-20190808-20190809,beaufort_sea-100km_by_100km-20200708-20200709,beaufort_sea-100km_by_100km-20200708-20200709,beaufort_sea-100km_by_100km-20200808-20200809,beaufort_sea-100km_by_100km-20200808-20200809,beaufort_sea-100km_by_100km-20210427-20210428,beaufort_sea-100km_by_100km-20210427-20210428,beaufort_sea-100km_by_100km-20210718-20210719,beaufort_sea-100km_by_100km-20210718-20210719,beaufort_sea-100km_by_100km-20220302-20220303,beaufort_sea-100km_by_100km-20220302-20220303,beaufort_sea-100km_by_100km-20220523-20220524,beaufort_sea-100km_by_100km-20220523-20220524"
    startdate="2003-04-22,2003-04-22,2003-05-27,2003-05-27,2003-06-16,2003-06-16,2003-06-21,2003-06-21,2004-04-28,2004-04-28,2007-07-11,2007-07-11,2010-03-30,2010-03-30,2010-09-25,2010-09-25,2011-06-08,2011-06-08,2014-08-18,2014-08-18,2017-05-25,2017-05-25,2017-09-25,2017-09-25,2018-09-25,2018-09-25,2019-03-19,2019-03-19,2019-08-08,2019-08-08,2020-07-08,2020-07-08,2020-08-08,2020-08-08,2021-04-27,2021-04-27,2021-07-18,2021-07-18,2022-03-02,2022-03-02,2022-05-23,2022-05-23"
    enddate="2003-04-23,2003-04-23,2003-05-28,2003-05-28,2003-06-17,2003-06-17,2003-06-22,2003-06-22,2004-04-29,2004-04-29,2007-07-12,2007-07-12,2010-03-31,2010-03-31,2010-09-26,2010-09-26,2011-06-09,2011-06-09,2014-08-19,2014-08-19,2017-05-26,2017-05-26,2017-09-26,2017-09-26,2018-09-26,2018-09-26,2019-03-20,2019-03-20,2019-08-09,2019-08-09,2020-07-09,2020-07-09,2020-08-09,2020-08-09,2021-04-28,2021-04-28,2021-07-19,2021-07-19,2022-03-03,2022-03-03,2022-05-24,2022-05-24"
    crs="epsg3413"
    bounding_box="-2112499.9999@-312500.00108@-2012499.9999@-412500.00108,-2112499.9999@-312500.00108@-2012499.9999@-412500.00108,-1987499.99993@-162499.99982@-1887499.99993@-262499.99982,-1987499.99993@-162499.99982@-1887499.99993@-262499.99982,-2137499.99997@12500.00016@-2037499.99997@-87499.99984,-2137499.99997@12500.00016@-2037499.99997@-87499.99984,-2287500.00031@37500.00093@-2187500.00031@-62499.99907,-2287500.00031@37500.00093@-2187500.00031@-62499.99907,-2112499.99996@-387499.99833@-2012499.99996@-487499.99833,-2112499.99996@-387499.99833@-2012499.99996@-487499.99833,-1612499.99973@-137499.99962@-1512499.99973@-237499.99962,-1612499.99973@-137499.99962@-1512499.99973@-237499.99962,-1612500.00013@-487500.00129@-1512500.00013@-587500.00129,-1612500.00013@-487500.00129@-1512500.00013@-587500.00129,-1462499.99988@162500.00051@-1362499.99988@62500.00051,-1462499.99988@162500.00051@-1362499.99988@62500.00051,-2112500.00041@-187499.99925@-2012500.00041@-287499.99925,-2112500.00041@-187499.99925@-2012500.00041@-287499.99925,-1612499.99986@-462500.00096@-1512499.99986@-562500.00096,-1612499.99986@-462500.00096@-1512499.99986@-562500.00096,-1987500.00058@-262499.99851@-1887500.00058@-362499.99851,-1987500.00058@-262499.99851@-1887500.00058@-362499.99851,-1287499.99997@337500.00045@-1187499.99997@237500.00045,-1287499.99997@337500.00045@-1187499.99997@237500.00045,-1487500.00022@412500.00038@-1387500.00022@312500.00038,-1487500.00022@412500.00038@-1387500.00022@312500.00038,-2112499.99941@-162500.0003@-2012499.99941@-262500.0003,-2112499.99941@-162500.0003@-2012499.99941@-262500.0003,-1837500.00022@-62499.99947@-1737500.00022@-162499.99947,-1837500.00022@-62499.99947@-1737500.00022@-162499.99947,-2212500.00026@337499.99848@-2112500.00026@237499.99848,-2212500.00026@337499.99848@-2112500.00026@237499.99848,-1662499.99993@487499.99894@-1562499.99993@387499.99894,-1662499.99993@487499.99894@-1562499.99993@387499.99894,-2212500.00003@262499.99889@-2112500.00003@162499.99889,-2212500.00003@262499.99889@-2112500.00003@162499.99889,-2087500.00003@112499.99965@-1987500.00003@12499.99965,-2087500.00003@112499.99965@-1987500.00003@12499.99965,-2187499.99987@287499.99825@-2087499.99987@187499.99825,-2187499.99987@287499.99825@-2087499.99987@187499.99825,-2212500.00017@-37500.00054@-2112500.00017@-137500.00054,-2212500.00017@-37500.00054@-2112500.00017@-137500.00054"
    centroid_lat="70.84194606,70.84194606,72.14716003,72.14716003,70.89835245,70.89835245,69.5556339,69.5556339,70.71368137,70.71368137,75.54667812,75.54667812,74.83217276,74.83217276,76.97365651,76.97365651,71.00358362,71.00358362,74.9044512,74.9044512,72.02614964,72.02614964,78.31111945,78.31111945,76.37656087,76.37656087,71.02795657,71.02795657,73.57529893,73.57529893,70.05737285,70.05737285,74.6649074,74.6649074,70.13458851,70.13458851,71.34239041,71.34239041,70.3342717,70.3342717,70.21212906,70.21212906"
    centroid_lon="-125.0316438,-125.0316438,-128.7409637,-128.7409637,-133.9708452,-133.9708452,-134.6799152,-134.6799152,-123.0238676,-123.0238676,-128.1572266,-128.1572266,-116.0167829,-116.0167829,-139.553768,-139.553768,-128.4312359,-128.4312359,-116.8405095,-116.8405095,-125.837653,-125.837653,-148.0791238,-148.0791238,-149.1534126,-149.1534126,-129.1175544,-129.1175544,-131.3987219,-131.3987219,-142.5729486,-142.5729486,-150.1799274,-150.1799274,-140.6122032,-140.6122032,-136.7569883,-136.7569883,-141.3401917,-141.3401917,-132.6829376,-132.6829376"
    minfloearea="100"
    maxfloearea="90000"
    project_dir=~/"ice-floe-tracker-pipeline"
    t="${CYLC_WORKFLOW_INITIAL_CYCLE_POINT}"
    julia_exec="/usr/local/julia/bin/julia"
    report_dir="$project_dir/"workflow/report""
    results_dir="$project_dir/"results"/$t"
    fetchdata_dir="$project_dir/"resources"/$t"
    truecolor_dir="$fetchdata_dir/"truecolor""
    falsecolor_dir="$fetchdata_dir/"falsecolor""
}

cylc__job__inst__script() {
# SCRIPT:
i=${CYLC_TASK_PARAM_param_set}
location_array=( $(echo $location | sed -e 's/,/ /g') )
res=$results_dir/${location_array[$i]}
mkdir -p $fetchdata_dir/${location_array[$i]}
mkdir -p $res/soit
mkdir -p $res/landmasks
mkdir -p $res/preprocess
mkdir -p $res/tracker
mkdir -p $res/preprocess/hdf5-files
}

CYLC_RUN_DIR="${CYLC_RUN_DIR:-$HOME/cylc-run}"
. "${CYLC_RUN_DIR}/${CYLC_WORKFLOW_ID}/.service/etc/job.sh"
cylc__job__main

#EOF: 20240319T1535Z/mkpaths_param_set41/01
